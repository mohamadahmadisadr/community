# Jobs Database Structure - Iranian Community Admin Panel

## Overview
This document defines the complete database structure for jobs in the Iranian Community Admin Panel. The structure is designed for Firebase Firestore but can be adapted to other NoSQL or SQL databases.

## Collection: `jobs`

### Document Structure

```javascript
{
  // Document ID (auto-generated by Firestore)
  id: "string", // Auto-generated document ID
  
  // Basic Job Information
  title: "string", // Required - Job title
  description: "string", // Required - Detailed job description
  company: "string", // Required - Company name
  category: "string", // Required - Job category (see categories below)
  type: "string", // Required - Job type (see types below)
  
  // Location Information
  location: {
    city: "string", // Required - City name
    province: "string", // Required - Province/State
    remote: "boolean" // Whether job allows remote work
  },
  
  // Salary Information
  salary: {
    min: "number", // Optional - Minimum salary
    max: "number", // Optional - Maximum salary
    currency: "string", // Currency code (default: "CAD")
    period: "string" // Salary period (see periods below)
  },
  
  // Job Requirements and Benefits
  requirements: ["string"], // Array of job requirements
  benefits: ["string"], // Array of job benefits
  
  // Contact Information
  contactEmail: "string", // Required - Contact email for applications
  contactPhone: "string", // Optional - Contact phone number
  applicationUrl: "string", // Optional - External application URL
  
  // Status and Settings
  status: "string", // Required - Job status (see statuses below)
  featured: "boolean", // Whether job is featured (default: false)
  expiryDate: "timestamp", // Optional - Job expiry date
  
  // Metadata
  userId: "string", // ID of user who created the job
  createdAt: "timestamp", // Firestore server timestamp
  updatedAt: "timestamp" // Firestore server timestamp
}
```

## Field Specifications

### Required Fields
- `title` (string, min 3 characters)
- `description` (string, min 10 characters)
- `company` (string)
- `category` (string, must be from predefined categories)
- `type` (string, must be from predefined types)
- `location.city` (string, must be from predefined cities)
- `location.province` (string, must be from predefined provinces)
- `contactEmail` (string, valid email format)
- `status` (string, must be from predefined statuses)

### Optional Fields
- `location.remote` (boolean, default: false)
- `salary.min` (number, >= 0)
- `salary.max` (number, >= 0, must be >= min if both provided)
- `salary.currency` (string, default: "CAD")
- `salary.period` (string, default: "yearly")
- `requirements` (array of strings)
- `benefits` (array of strings)
- `contactPhone` (string)
- `applicationUrl` (string, valid URL)
- `featured` (boolean, default: false)
- `expiryDate` (timestamp, must be in the future)

### Validation Rules
- If both `salary.min` and `salary.max` are provided, max must be >= min
- `expiryDate` must be in the future if provided
- `contactEmail` must be valid email format
- `applicationUrl` must be valid URL if provided

## Predefined Values

### Job Categories
```javascript
const JOB_CATEGORIES = [
  "Technology",
  "Healthcare",
  "Education",
  "Finance",
  "Engineering",
  "Marketing",
  "Sales",
  "Customer Service",
  "Administration",
  "Construction",
  "Transportation",
  "Food Service",
  "Retail",
  "Other"
];
```

### Job Types
```javascript
const JOB_TYPES = [
  "full-time",
  "part-time",
  "contract",
  "internship",
  "temporary",
  "freelance"
];
```

### Job Statuses
```javascript
const JOB_STATUSES = [
  "draft",      // Job is being created/edited
  "pending",    // Waiting for admin approval
  "approved",   // Approved and visible to public
  "rejected",   // Rejected by admin
  "expired",    // Job has expired
  "filled"      // Position has been filled
];
```

### Salary Periods
```javascript
const SALARY_PERIODS = [
  "yearly",     // Annual salary
  "monthly",    // Monthly salary
  "weekly",     // Weekly salary
  "daily",      // Daily rate
  "hourly"      // Hourly rate
];
```

### Currency Codes
```javascript
const CURRENCIES = [
  "CAD",        // Canadian Dollar (default)
  "USD",        // US Dollar
  "EUR",        // Euro
  "GBP"         // British Pound
];
```

### Cities (Canadian Focus)
```javascript
const CITIES = [
  "Toronto",
  "Montreal",
  "Vancouver",
  "Calgary",
  "Edmonton",
  "Ottawa",
  "Winnipeg",
  "Quebec City",
  "Hamilton",
  "Kitchener",
  "London",
  "Victoria",
  "Halifax",
  "Oshawa",
  "Windsor",
  "Saskatoon",
  "Regina",
  "Sherbrooke",
  "St. Johns",
  "Barrie"
];
```

### Provinces (Canada)
```javascript
const PROVINCES = [
  "Alberta",
  "British Columbia",
  "Manitoba",
  "New Brunswick",
  "Newfoundland and Labrador",
  "Northwest Territories",
  "Nova Scotia",
  "Nunavut",
  "Ontario",
  "Prince Edward Island",
  "Quebec",
  "Saskatchewan",
  "Yukon"
];
```

## Data Types and Formats

### Timestamps
- **Storage**: Firestore Timestamp objects
- **API**: ISO 8601 strings (YYYY-MM-DDTHH:mm:ss.sssZ)
- **Form Input**: Date strings (YYYY-MM-DD)

### Numbers
- **salary.min/max**: Integer or Float (e.g., 75000, 25.50)
- **Validation**: Must be positive numbers

### Arrays
- **requirements**: Array of strings (e.g., ["Bachelor's degree", "3+ years experience"])
- **benefits**: Array of strings (e.g., ["Health insurance", "Dental coverage"])

### Strings
- **contactEmail**: Valid email format
- **applicationUrl**: Valid URL format
- **contactPhone**: Phone number format (flexible)

## Example Documents

### Full-Time Technology Job Example
```javascript
{
  id: "job_123",
  title: "Senior React Developer",
  description: "We are looking for an experienced React developer to join our growing team. You will be responsible for developing user interface components and implementing them following well-known React.js workflows.",
  company: "TechCorp Solutions",
  category: "Technology",
  type: "full-time",
  location: {
    city: "Toronto",
    province: "Ontario",
    remote: true
  },
  salary: {
    min: 80000,
    max: 120000,
    currency: "CAD",
    period: "yearly"
  },
  requirements: [
    "Bachelor's degree in Computer Science or related field",
    "5+ years of experience with React.js",
    "Strong knowledge of JavaScript, HTML, CSS",
    "Experience with Redux or similar state management",
    "Familiarity with RESTful APIs"
  ],
  benefits: [
    "Comprehensive health and dental insurance",
    "Flexible working hours",
    "Remote work options",
    "Professional development budget",
    "Stock options"
  ],
  contactEmail: "careers@techcorp.ca",
  contactPhone: "+1-416-555-0123",
  applicationUrl: "https://techcorp.ca/careers/senior-react-developer",
  status: "approved",
  featured: true,
  expiryDate: "2024-06-30T23:59:59.000Z",
  userId: "user_456",
  createdAt: "2024-03-15T10:30:00.000Z",
  updatedAt: "2024-03-20T14:15:00.000Z"
}
```

### Part-Time Service Job Example
```javascript
{
  id: "job_789",
  title: "Customer Service Representative",
  description: "Join our customer service team to help clients with inquiries and support. Perfect for someone looking for flexible part-time work with growth opportunities.",
  company: "Community Services Inc.",
  category: "Customer Service",
  type: "part-time",
  location: {
    city: "Vancouver",
    province: "British Columbia",
    remote: false
  },
  salary: {
    min: 18,
    max: 22,
    currency: "CAD",
    period: "hourly"
  },
  requirements: [
    "High school diploma or equivalent",
    "Excellent communication skills",
    "Bilingual (English/Farsi) preferred",
    "Previous customer service experience an asset"
  ],
  benefits: [
    "Flexible scheduling",
    "Employee discounts",
    "Training provided"
  ],
  contactEmail: "hr@communityservices.ca",
  contactPhone: "",
  applicationUrl: "",
  status: "approved",
  featured: false,
  expiryDate: null,
  userId: "user_789",
  createdAt: "2024-03-10T09:00:00.000Z",
  updatedAt: "2024-03-10T09:00:00.000Z"
}
```

## Validation Rules Summary

1. **Title**: Required, minimum 3 characters
2. **Description**: Required, minimum 10 characters
3. **Company**: Required
4. **Category**: Required, must be from predefined list
5. **Type**: Required, must be from predefined list
6. **Location**: City and province required from predefined lists
7. **Salary**: If both min and max provided, max must be >= min
8. **Contact Email**: Required, must be valid email format
9. **Application URL**: Must be valid URL if provided
10. **Expiry Date**: Must be in the future if provided
11. **Status**: Must be from predefined list

## Indexes Recommended

For optimal query performance, create these Firestore indexes:

```javascript
// Composite indexes
jobs: [
  ["status", "createdAt"],
  ["category", "status", "createdAt"],
  ["type", "status", "createdAt"],
  ["location.city", "status", "createdAt"],
  ["location.province", "status", "createdAt"],
  ["featured", "status", "createdAt"],
  ["userId", "createdAt"],
  ["expiryDate", "status"]
]

// Single field indexes (auto-created)
- status
- category
- type
- location.city
- location.province
- featured
- userId
- createdAt
- expiryDate
```

## Security Rules (Firestore)

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /jobs/{jobId} {
      // Allow read for approved jobs
      allow read: if resource.data.status == 'approved';

      // Allow admin users to read all jobs
      allow read: if request.auth != null &&
                     get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';

      // Allow users to create jobs (will be pending)
      allow create: if request.auth != null &&
                       request.resource.data.userId == request.auth.uid &&
                       request.resource.data.status == 'pending';

      // Allow users to update their own jobs (if not approved yet)
      allow update: if request.auth != null &&
                       resource.data.userId == request.auth.uid &&
                       resource.data.status in ['draft', 'pending'];

      // Allow admin to update any job
      allow update: if request.auth != null &&
                       get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';

      // Allow admin to delete jobs
      allow delete: if request.auth != null &&
                       get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
  }
}
```

## Form Validation Schema (Yup)

```javascript
const jobValidationSchema = yup.object({
  title: yup.string()
    .required('Job title is required')
    .min(3, 'Title must be at least 3 characters'),

  company: yup.string()
    .required('Company name is required'),

  description: yup.string()
    .required('Job description is required')
    .min(10, 'Description must be at least 10 characters'),

  category: yup.string()
    .required('Category is required')
    .oneOf(JOB_CATEGORIES, 'Invalid category'),

  type: yup.string()
    .required('Job type is required')
    .oneOf(JOB_TYPES, 'Invalid job type'),

  location: yup.object({
    city: yup.string()
      .required('City is required')
      .oneOf(CITIES, 'Invalid city'),

    province: yup.string()
      .required('Province is required')
      .oneOf(PROVINCES, 'Invalid province'),

    remote: yup.boolean()
      .default(false)
  }),

  salary: yup.object({
    min: yup.number()
      .min(0, 'Minimum salary must be positive')
      .nullable(),

    max: yup.number()
      .min(0, 'Maximum salary must be positive')
      .test('max-greater-than-min', 'Maximum salary must be greater than minimum',
        function(value) {
          const { min } = this.parent;
          if (min && value) {
            return value >= min;
          }
          return true;
        })
      .nullable(),

    currency: yup.string()
      .default('CAD')
      .oneOf(CURRENCIES, 'Invalid currency'),

    period: yup.string()
      .default('yearly')
      .oneOf(SALARY_PERIODS, 'Invalid salary period')
  }),

  requirements: yup.array()
    .of(yup.string())
    .default([]),

  benefits: yup.array()
    .of(yup.string())
    .default([]),

  contactEmail: yup.string()
    .required('Contact email is required')
    .email('Invalid email format'),

  contactPhone: yup.string()
    .nullable(),

  applicationUrl: yup.string()
    .url('Invalid URL format')
    .nullable(),

  expiryDate: yup.date()
    .min(new Date(), 'Expiry date must be in the future')
    .nullable(),

  status: yup.string()
    .required('Status is required')
    .oneOf(JOB_STATUSES, 'Invalid status'),

  featured: yup.boolean()
    .default(false)
});
```

## API Endpoints Structure

```javascript
// GET /api/jobs - Get all approved jobs with filtering
{
  query: {
    category?: string,
    type?: string,
    city?: string,
    province?: string,
    remote?: boolean,
    featured?: boolean,
    salaryMin?: number,
    salaryMax?: number,
    page?: number,
    limit?: number,
    search?: string
  }
}

// POST /api/jobs - Create new job
{
  body: JobDocument // (status will be set to 'pending')
}

// PUT /api/jobs/:id - Update job
{
  params: { id: string },
  body: Partial<JobDocument>
}

// DELETE /api/jobs/:id - Delete job (admin only)
{
  params: { id: string }
}

// GET /api/jobs/:id - Get specific job
{
  params: { id: string }
}
```

## Search and Filtering

### Search Fields
Jobs can be searched by:
- `title` (full-text search)
- `description` (full-text search)
- `company` (full-text search)
- `requirements` (array contains)

### Filter Options
- **Category**: Filter by job category
- **Type**: Filter by job type (full-time, part-time, etc.)
- **Location**: Filter by city and/or province
- **Remote**: Filter remote-friendly jobs
- **Salary Range**: Filter by minimum and maximum salary
- **Featured**: Show only featured jobs
- **Status**: Filter by job status (admin only)

### Sort Options
- **Date**: Most recent first (default)
- **Salary**: Highest to lowest
- **Company**: Alphabetical
- **Title**: Alphabetical
- **Expiry**: Expiring soon first

## Analytics and Metrics

### Job Metrics to Track
```javascript
{
  totalJobs: number,
  activeJobs: number,
  expiredJobs: number,
  jobsByCategory: { [category]: number },
  jobsByType: { [type]: number },
  jobsByLocation: { [city]: number },
  averageSalary: { [category]: number },
  jobsCreatedThisMonth: number,
  jobsExpiredThisMonth: number,
  featuredJobs: number
}
```

### User Engagement Metrics
```javascript
{
  jobViews: number,
  jobApplications: number,
  topCategories: string[],
  topCompanies: string[],
  searchQueries: string[],
  conversionRate: number // applications / views
}
```

---

**Note**: This structure is designed for the Iranian Community Admin Panel's job board functionality and can be adapted for other community job platforms. The structure supports comprehensive job management with admin approval workflows, flexible salary structures, and detailed filtering capabilities.
