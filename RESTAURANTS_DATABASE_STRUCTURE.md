 # Restaurants Database Structure - Iranian Community Admin Panel

## Overview
This document defines the complete database structure for restaurants in the Iranian Community Admin Panel. The structure is designed for Firebase Firestore but can be adapted to other NoSQL or SQL databases.

## Collection: `restaurants`

### Document Structure

```javascript
{
  // Document ID (auto-generated by Firestore)
  id: "string", // Auto-generated document ID
  
  // Basic Restaurant Information
  name: "string", // Required - Restaurant name
  description: "string", // Required - Restaurant description
  cuisine: "string", // Required - Primary cuisine type
  category: "string", // Required - Restaurant category (see categories below)
  
  // Location Information
  location: {
    address: "string", // Required - Street address
    city: "string", // Required - City name
    province: "string", // Required - Province/State
    postalCode: "string", // Optional - Postal/ZIP code
    coordinates: { // Optional - GPS coordinates
      lat: "number",
      lng: "number"
    }
  },
  
  // Contact Information
  contactInfo: {
    phone: "string", // Optional - Phone number (not required)
    email: "string", // Optional - Email address
    website: "string" // Optional - Website URL
  },
  
  // Business Hours
  hours: {
    monday: "string", // Format: "HH:MM-HH:MM" or "Closed"
    tuesday: "string",
    wednesday: "string",
    thursday: "string",
    friday: "string",
    saturday: "string",
    sunday: "string"
  },
  
  // Pricing and Features
  priceRange: "string", // Required - Price range (see price ranges below)
  rating: "number", // Average rating (0-5)
  features: ["string"], // Array of restaurant features
  
  // Status and Settings
  status: "string", // Required - Restaurant status (see statuses below)
  featured: "boolean", // Whether restaurant is featured (default: false)
  
  // Metadata
  userId: "string", // ID of user who created the restaurant
  createdAt: "timestamp", // Firestore server timestamp
  updatedAt: "timestamp" // Firestore server timestamp
}
```

## Field Specifications

### Required Fields
- `name` (string, min 3 characters)
- `description` (string, min 10 characters)
- `cuisine` (string, must be from predefined cuisines)
- `category` (string, must be from predefined categories)
- `location.address` (string)
- `location.city` (string, must be from predefined cities)
- `location.province` (string, must be from predefined provinces)
- `priceRange` (string, must be from predefined ranges)
- `status` (string, must be from predefined statuses)

### Optional Fields
- `location.postalCode` (string)
- `location.coordinates` (object with lat/lng)
- `contactInfo.phone` (string) - **Note: Phone is NOT required for restaurants**
- `contactInfo.email` (string, valid email format)
- `contactInfo.website` (string, valid URL format)
- `hours` (object with daily hours)
- `rating` (number, 0-5)
- `features` (array of strings)
- `featured` (boolean, default: false)

### Validation Rules
- `rating` must be between 0 and 5
- `contactInfo.email` must be valid email format if provided
- `contactInfo.website` must be valid URL if provided
- Hours format: "HH:MM-HH:MM" (24-hour) or "Closed"

## Predefined Values

### Restaurant Categories
```javascript
const RESTAURANT_CATEGORIES = [
  "Persian",
  "Middle Eastern",
  "Mediterranean",
  "Fast Food",
  "Fine Dining",
  "Casual Dining",
  "Cafe",
  "Bakery",
  "Dessert",
  "Vegetarian",
  "Halal",
  "Other"
];
```

### Cuisine Types
```javascript
const CUISINE_TYPES = [
  "Persian",
  "Middle Eastern",
  "Mediterranean",
  "Turkish",
  "Lebanese",
  "Afghan",
  "Pakistani",
  "Indian",
  "International",
  "Fusion",
  "Vegetarian",
  "Vegan",
  "Halal",
  "Other"
];
```

### Price Ranges
```javascript
const PRICE_RANGES = [
  "$",      // Budget-friendly (Under $15 per person)
  "$$",     // Moderate ($15-30 per person)
  "$$$",    // Expensive ($30-50 per person)
  "$$$$"    // Very Expensive ($50+ per person)
];
```

### Restaurant Statuses
```javascript
const RESTAURANT_STATUSES = [
  "draft",      // Restaurant is being created/edited
  "pending",    // Waiting for admin approval
  "approved",   // Approved and visible to public
  "rejected",   // Rejected by admin
  "closed",     // Restaurant is temporarily closed
  "permanently_closed" // Restaurant is permanently closed
];
```

### Restaurant Features
```javascript
const RESTAURANT_FEATURES = [
  "Dine-in",
  "Takeout",
  "Delivery",
  "Drive-through",
  "Outdoor Seating",
  "Private Dining",
  "Catering",
  "Live Music",
  "WiFi",
  "Parking Available",
  "Wheelchair Accessible",
  "Family Friendly",
  "Pet Friendly",
  "Halal Certified",
  "Vegetarian Options",
  "Vegan Options",
  "Alcohol Served",
  "BYOB",
  "Reservations Required",
  "Group Bookings",
  "Credit Cards Accepted",
  "Cash Only"
];
```

### Cities (Canadian Focus)
```javascript
const CITIES = [
  "Toronto",
  "Montreal",
  "Vancouver",
  "Calgary",
  "Edmonton",
  "Ottawa",
  "Winnipeg",
  "Quebec City",
  "Hamilton",
  "Kitchener",
  "London",
  "Victoria",
  "Halifax",
  "Oshawa",
  "Windsor",
  "Saskatoon",
  "Regina",
  "Sherbrooke",
  "St. Johns",
  "Barrie"
];
```

### Provinces (Canada)
```javascript
const PROVINCES = [
  "Alberta",
  "British Columbia",
  "Manitoba",
  "New Brunswick",
  "Newfoundland and Labrador",
  "Northwest Territories",
  "Nova Scotia",
  "Nunavut",
  "Ontario",
  "Prince Edward Island",
  "Quebec",
  "Saskatchewan",
  "Yukon"
];
```

## Data Types and Formats

### Timestamps
- **Storage**: Firestore Timestamp objects
- **API**: ISO 8601 strings (YYYY-MM-DDTHH:mm:ss.sssZ)

### Numbers
- **rating**: Float between 0.0 and 5.0 (e.g., 4.5)
- **coordinates.lat/lng**: Float (e.g., 43.6532, -79.3832)

### Arrays
- **features**: Array of strings from predefined features list

### Strings
- **hours**: Format "HH:MM-HH:MM" (e.g., "11:00-22:00") or "Closed"
- **contactInfo.email**: Valid email format
- **contactInfo.website**: Valid URL format
- **contactInfo.phone**: Flexible phone format

## Example Documents

### Persian Fine Dining Restaurant Example
```javascript
{
  id: "restaurant_123",
  name: "Persian Palace Restaurant",
  description: "Authentic Persian cuisine in an elegant setting. We offer traditional dishes prepared with the finest ingredients, featuring kebabs, stews, and aromatic rice dishes.",
  cuisine: "Persian",
  category: "Fine Dining",
  location: {
    address: "123 Yonge Street",
    city: "Toronto",
    province: "Ontario",
    postalCode: "M5C 1W4",
    coordinates: {
      lat: 43.6532,
      lng: -79.3832
    }
  },
  contactInfo: {
    phone: "+1-416-555-0123",
    email: "info@persianpalace.ca",
    website: "https://persianpalace.ca"
  },
  hours: {
    monday: "17:00-22:00",
    tuesday: "17:00-22:00",
    wednesday: "17:00-22:00",
    thursday: "17:00-22:00",
    friday: "17:00-23:00",
    saturday: "17:00-23:00",
    sunday: "16:00-21:00"
  },
  priceRange: "$$$",
  rating: 4.7,
  features: [
    "Dine-in",
    "Takeout",
    "Private Dining",
    "Reservations Required",
    "Halal Certified",
    "Parking Available",
    "Credit Cards Accepted",
    "Alcohol Served"
  ],
  status: "approved",
  featured: true,
  userId: "user_456",
  createdAt: "2024-03-15T10:30:00.000Z",
  updatedAt: "2024-03-20T14:15:00.000Z"
}
```

### Casual Middle Eastern Restaurant Example
```javascript
{
  id: "restaurant_789",
  name: "Babylon Grill",
  description: "Fast-casual Middle Eastern restaurant serving fresh shawarma, falafel, and Mediterranean favorites. Perfect for a quick, healthy meal.",
  cuisine: "Middle Eastern",
  category: "Casual Dining",
  location: {
    address: "456 Bloor Street West",
    city: "Toronto",
    province: "Ontario",
    postalCode: "M5S 1X8",
    coordinates: {
      lat: 43.6629,
      lng: -79.4010
    }
  },
  contactInfo: {
    phone: "", // Phone not provided
    email: "orders@babylongrill.ca",
    website: ""
  },
  hours: {
    monday: "11:00-21:00",
    tuesday: "11:00-21:00",
    wednesday: "11:00-21:00",
    thursday: "11:00-21:00",
    friday: "11:00-22:00",
    saturday: "11:00-22:00",
    sunday: "12:00-20:00"
  },
  priceRange: "$$",
  rating: 4.2,
  features: [
    "Dine-in",
    "Takeout",
    "Delivery",
    "Halal Certified",
    "Vegetarian Options",
    "Family Friendly",
    "Credit Cards Accepted"
  ],
  status: "approved",
  featured: false,
  userId: "user_789",
  createdAt: "2024-03-10T09:00:00.000Z",
  updatedAt: "2024-03-10T09:00:00.000Z"
}
```

## Validation Rules Summary

1. **Name**: Required, minimum 3 characters
2. **Description**: Required, minimum 10 characters
3. **Cuisine**: Required, must be from predefined list
4. **Category**: Required, must be from predefined list
5. **Location**: Address, city, and province required from predefined lists
6. **Price Range**: Required, must be from predefined ranges ($, $$, $$$, $$$$)
7. **Contact Info**: All fields optional, but email must be valid format if provided
8. **Rating**: Must be between 0 and 5 if provided
9. **Hours**: Must follow "HH:MM-HH:MM" format or "Closed"
10. **Status**: Must be from predefined list

## Indexes Recommended

For optimal query performance, create these Firestore indexes:

```javascript
// Composite indexes
restaurants: [
  ["status", "createdAt"],
  ["category", "status", "createdAt"],
  ["cuisine", "status", "createdAt"],
  ["location.city", "status", "createdAt"],
  ["location.province", "status", "createdAt"],
  ["priceRange", "status", "createdAt"],
  ["featured", "status", "createdAt"],
  ["rating", "status", "createdAt"],
  ["userId", "createdAt"]
]

// Single field indexes (auto-created)
- status
- category
- cuisine
- location.city
- location.province
- priceRange
- featured
- rating
- userId
- createdAt
```

## Security Rules (Firestore)

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /restaurants/{restaurantId} {
      // Allow read for approved restaurants
      allow read: if resource.data.status == 'approved';

      // Allow admin users to read all restaurants
      allow read: if request.auth != null &&
                     get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';

      // Allow users to create restaurants (will be pending)
      allow create: if request.auth != null &&
                       request.resource.data.userId == request.auth.uid &&
                       request.resource.data.status == 'pending';

      // Allow users to update their own restaurants (if not approved yet)
      allow update: if request.auth != null &&
                       resource.data.userId == request.auth.uid &&
                       resource.data.status in ['draft', 'pending'];

      // Allow admin to update any restaurant
      allow update: if request.auth != null &&
                       get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';

      // Allow admin to delete restaurants
      allow delete: if request.auth != null &&
                       get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
  }
}
```

## Form Validation Schema (Yup)

```javascript
const restaurantValidationSchema = yup.object({
  name: yup.string()
    .required('Restaurant name is required')
    .min(3, 'Name must be at least 3 characters'),

  description: yup.string()
    .required('Description is required')
    .min(10, 'Description must be at least 10 characters'),

  cuisine: yup.string()
    .required('Cuisine type is required')
    .oneOf(CUISINE_TYPES, 'Invalid cuisine type'),

  category: yup.string()
    .required('Category is required')
    .oneOf(RESTAURANT_CATEGORIES, 'Invalid category'),

  location: yup.object({
    address: yup.string()
      .required('Address is required'),

    city: yup.string()
      .required('City is required')
      .oneOf(CITIES, 'Invalid city'),

    province: yup.string()
      .required('Province is required')
      .oneOf(PROVINCES, 'Invalid province'),

    postalCode: yup.string()
      .nullable()
  }),

  contactInfo: yup.object({
    phone: yup.string()
      .nullable(), // Phone is NOT required for restaurants

    email: yup.string()
      .email('Invalid email format')
      .nullable(),

    website: yup.string()
      .url('Invalid URL format')
      .nullable()
  }),

  hours: yup.object({
    monday: yup.string().nullable(),
    tuesday: yup.string().nullable(),
    wednesday: yup.string().nullable(),
    thursday: yup.string().nullable(),
    friday: yup.string().nullable(),
    saturday: yup.string().nullable(),
    sunday: yup.string().nullable()
  }),

  priceRange: yup.string()
    .required('Price range is required')
    .oneOf(PRICE_RANGES, 'Invalid price range'),

  rating: yup.number()
    .min(0, 'Rating must be at least 0')
    .max(5, 'Rating cannot exceed 5')
    .nullable(),

  features: yup.array()
    .of(yup.string().oneOf(RESTAURANT_FEATURES, 'Invalid feature'))
    .default([]),

  status: yup.string()
    .required('Status is required')
    .oneOf(RESTAURANT_STATUSES, 'Invalid status'),

  featured: yup.boolean()
    .default(false)
});
```

## Search and Filtering

### Search Fields
Restaurants can be searched by:
- `name` (full-text search)
- `description` (full-text search)
- `cuisine` (exact match)
- `features` (array contains)

### Filter Options
- **Category**: Filter by restaurant category
- **Cuisine**: Filter by cuisine type
- **Location**: Filter by city and/or province
- **Price Range**: Filter by price range ($, $$, $$$, $$$$)
- **Features**: Filter by specific features (delivery, halal, etc.)
- **Rating**: Filter by minimum rating
- **Featured**: Show only featured restaurants
- **Status**: Filter by status (admin only)

### Sort Options
- **Rating**: Highest to lowest (default)
- **Name**: Alphabetical
- **Date**: Most recent first
- **Price**: Lowest to highest
- **Distance**: Nearest first (if location provided)

## Analytics and Metrics

### Restaurant Metrics to Track
```javascript
{
  totalRestaurants: number,
  activeRestaurants: number,
  closedRestaurants: number,
  restaurantsByCategory: { [category]: number },
  restaurantsByCuisine: { [cuisine]: number },
  restaurantsByLocation: { [city]: number },
  restaurantsByPriceRange: { [range]: number },
  averageRating: number,
  restaurantsCreatedThisMonth: number,
  featuredRestaurants: number
}
```

---

**Note**: This structure is designed for the Iranian Community Admin Panel's restaurant directory and can be adapted for other community restaurant platforms. The structure supports comprehensive restaurant management with admin approval workflows, flexible contact information (phone not required), and detailed filtering capabilities.
