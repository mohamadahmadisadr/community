# Rent Database Structure

This document defines the complete database structure for the rent/housing collection in the Iranian Community App.

## Collection: `rent`

### Document Structure

```javascript
{
  // Document ID (auto-generated by Firestore)
  id: "string", // Auto-generated document ID
  
  // Basic Property Information
  title: "string", // Required - Property title
  description: "string", // Required - Detailed property description
  type: "string", // Required - Property type (see types below)
  category: "string", // Required - Rental category (see categories below)
  
  // Location Information
  location: {
    address: "string", // Required - Street address
    city: "string", // Required - City (from predefined list)
    province: "string", // Required - Province (from predefined list)
    postalCode: "string", // Optional - Postal code
    coordinates: { // Optional - GPS coordinates
      lat: "number", // Latitude
      lng: "number"  // Longitude
    }
  },
  
  // Property Details
  propertyDetails: {
    bedrooms: "number", // Required - Number of bedrooms
    bathrooms: "number", // Required - Number of bathrooms
    area: "number", // Required - Area in square feet
    furnished: "string", // Required - Furnished status (see options below)
    parking: "string", // Optional - Parking availability
    petPolicy: "string", // Optional - Pet policy
    smokingPolicy: "string" // Optional - Smoking policy
  },
  
  // Pricing Information
  pricing: {
    rent: "number", // Required - Monthly rent amount
    currency: "string", // Required - Currency (default: "CAD")
    deposit: "number", // Optional - Security deposit
    utilitiesIncluded: "array", // Optional - Array of included utilities
    additionalFees: "array" // Optional - Array of additional fees
  },
  
  // Contact Information
  contactInfo: {
    phone: "string", // Optional - Contact phone number
    email: "string", // Optional - Contact email
    preferredContact: "string" // Optional - Preferred contact method
  },
  
  // Features and Amenities
  features: "array", // Optional - Array of property features
  amenities: "array", // Optional - Array of building/area amenities
  
  // Availability
  availability: {
    availableFrom: "timestamp", // Required - Available from date
    leaseTerm: "string", // Required - Lease term (see options below)
    viewingSchedule: "string" // Optional - Viewing schedule info
  },
  
  // Media
  images: "array", // Optional - Array of image URLs
  virtualTour: "string", // Optional - Virtual tour URL
  
  // Status and Moderation
  status: "string", // Required - Listing status (see statuses below)
  featured: "boolean", // Whether listing is featured (default: false)
  verified: "boolean", // Whether listing is verified (default: false)
  
  // Analytics and Engagement
  views: "number", // Number of views (default: 0)
  inquiries: "number", // Number of inquiries (default: 0)
  
  // User Information
  userId: "string", // Required - ID of user who created the listing
  
  // Timestamps
  createdAt: "timestamp", // Required - Creation timestamp
  updatedAt: "timestamp" // Required - Last update timestamp
}
```

## Field Specifications

### Required Fields
- `title` (string, min 3 characters)
- `description` (string, min 10 characters)
- `type` (string, must be from predefined types)
- `category` (string, must be from predefined categories)
- `location.address` (string)
- `location.city` (string, must be from predefined cities)
- `location.province` (string, must be from predefined provinces)
- `propertyDetails.bedrooms` (number, >= 0)
- `propertyDetails.bathrooms` (number, >= 0)
- `propertyDetails.area` (number, > 0)
- `propertyDetails.furnished` (string, must be from predefined options)
- `pricing.rent` (number, > 0)
- `pricing.currency` (string, default: "CAD")
- `availability.availableFrom` (timestamp, cannot be more than 1 year in the past)
- `availability.leaseTerm` (string, must be from predefined terms)
- `status` (string, must be from predefined statuses)

### Optional Fields
- `location.postalCode` (string)
- `location.coordinates` (object with lat/lng)
- `propertyDetails.parking` (string)
- `propertyDetails.petPolicy` (string)
- `propertyDetails.smokingPolicy` (string)
- `pricing.deposit` (number, >= 0)
- `pricing.utilitiesIncluded` (array of strings)
- `pricing.additionalFees` (array of objects)
- `contactInfo.phone` (string)
- `contactInfo.email` (string, valid email format)
- `contactInfo.preferredContact` (string)
- `features` (array of strings)
- `amenities` (array of strings)
- `availability.viewingSchedule` (string)
- `images` (array of strings, valid URLs)
- `virtualTour` (string, valid URL)
- `featured` (boolean, default: false)
- `verified` (boolean, default: false)

### Validation Rules
- `pricing.rent` must be > 0
- `propertyDetails.area` must be > 0
- `propertyDetails.bedrooms` and `bathrooms` must be >= 0
- `contactInfo.email` must be valid email format if provided
- `images` must be valid URLs if provided
- `virtualTour` must be valid URL if provided
- `availability.availableFrom` cannot be more than 1 year in the past

## Predefined Values

### Property Types
```javascript
const PROPERTY_TYPES = [
  "apartment",
  "house",
  "condo",
  "townhouse",
  "basement",
  "room",
  "studio",
  "duplex",
  "other"
];
```

### Rental Categories
```javascript
const RENTAL_CATEGORIES = [
  "long-term", // 6+ months
  "short-term", // 1-6 months
  "temporary", // Less than 1 month
  "student-housing",
  "shared-accommodation",
  "vacation-rental"
];
```

### Furnished Status
```javascript
const FURNISHED_OPTIONS = [
  "furnished",
  "semi-furnished",
  "unfurnished"
];
```

### Lease Terms
```javascript
const LEASE_TERMS = [
  "month-to-month",
  "3-months",
  "6-months",
  "1-year",
  "2-years",
  "flexible",
  "negotiable"
];
```

### Status Options
```javascript
const STATUS_OPTIONS = [
  "pending",    // Awaiting admin approval
  "approved",   // Approved and visible
  "active",     // Same as approved (backward compatibility)
  "rejected",   // Rejected by admin
  "rented",     // Property has been rented
  "expired",    // Listing has expired
  "paused"      // Temporarily paused by owner
];
```

### Canadian Cities (Major Cities)
```javascript
const CANADIAN_CITIES = [
  // Ontario
  "Toronto", "Ottawa", "Hamilton", "London", "Kitchener", "Windsor", "Oshawa", "Barrie", "Kingston", "Guelph",
  
  // Quebec
  "Montreal", "Quebec City", "Laval", "Gatineau", "Longueuil", "Sherbrooke", "Saguenay", "Trois-RiviÃ¨res",
  
  // British Columbia
  "Vancouver", "Surrey", "Burnaby", "Richmond", "Abbotsford", "Coquitlam", "Kelowna", "Saanich", "Delta", "Langley",
  
  // Alberta
  "Calgary", "Edmonton", "Red Deer", "Lethbridge", "St. Albert", "Medicine Hat", "Grande Prairie",
  
  // Manitoba
  "Winnipeg", "Brandon", "Steinbach",
  
  // Saskatchewan
  "Saskatoon", "Regina", "Prince Albert",
  
  // Nova Scotia
  "Halifax", "Sydney", "Dartmouth",
  
  // New Brunswick
  "Saint John", "Moncton", "Fredericton",
  
  // Newfoundland and Labrador
  "St. John's", "Mount Pearl", "Corner Brook",
  
  // Prince Edward Island
  "Charlottetown", "Summerside",
  
  // Northwest Territories
  "Yellowknife",
  
  // Yukon
  "Whitehorse",
  
  // Nunavut
  "Iqaluit"
];
```

### Canadian Provinces
```javascript
const CANADIAN_PROVINCES = [
  "Alberta",
  "British Columbia",
  "Manitoba",
  "New Brunswick",
  "Newfoundland and Labrador",
  "Northwest Territories",
  "Nova Scotia",
  "Nunavut",
  "Ontario",
  "Prince Edward Island",
  "Quebec",
  "Saskatchewan",
  "Yukon"
];
```

### Property Features
```javascript
const PROPERTY_FEATURES = [
  // Interior Features
  "hardwood-floors",
  "carpet",
  "tile-floors",
  "fireplace",
  "walk-in-closet",
  "storage-space",
  "high-ceilings",
  "updated-kitchen",
  "granite-counters",
  "stainless-appliances",
  "dishwasher",
  "washer-dryer-hookup",
  "washer-dryer-included",
  "air-conditioning",
  "heating-included",
  "balcony",
  "patio",
  "garden-access",

  // Building Features
  "elevator",
  "wheelchair-accessible",
  "security-system",
  "intercom",
  "concierge",
  "doorman",

  // Utilities & Services
  "internet-included",
  "cable-included",
  "utilities-included",
  "heat-included",
  "hydro-included",
  "water-included"
];
```

### Building Amenities
```javascript
const BUILDING_AMENITIES = [
  "gym",
  "pool",
  "sauna",
  "hot-tub",
  "rooftop-terrace",
  "bbq-area",
  "party-room",
  "meeting-room",
  "business-center",
  "library",
  "playground",
  "dog-park",
  "bike-storage",
  "storage-lockers",
  "visitor-parking",
  "underground-parking",
  "surface-parking",
  "car-wash",
  "electric-car-charging",
  "24-hour-security",
  "video-surveillance",
  "controlled-access",
  "mail-room",
  "package-receiving",
  "dry-cleaning",
  "on-site-management"
];
```

### Utilities
```javascript
const UTILITIES = [
  "electricity",
  "gas",
  "water",
  "sewer",
  "trash",
  "internet",
  "cable",
  "phone",
  "heating",
  "air-conditioning"
];
```

### Parking Options
```javascript
const PARKING_OPTIONS = [
  "none",
  "street-parking",
  "driveway",
  "garage",
  "underground-garage",
  "surface-lot",
  "assigned-spot",
  "visitor-parking"
];
```

### Pet Policies
```javascript
const PET_POLICIES = [
  "no-pets",
  "cats-allowed",
  "dogs-allowed",
  "small-pets-only",
  "pets-negotiable",
  "pet-deposit-required"
];
```

### Smoking Policies
```javascript
const SMOKING_POLICIES = [
  "no-smoking",
  "smoking-allowed",
  "outdoor-smoking-only",
  "designated-smoking-areas"
];
```

## Data Types and Formats

### Timestamps
- **Storage**: Firestore Timestamp objects
- **API**: ISO 8601 strings (YYYY-MM-DDTHH:mm:ss.sssZ)

### Numbers
- **pricing.rent**: Float (e.g., 1500.00)
- **pricing.deposit**: Float (e.g., 1500.00)
- **propertyDetails.area**: Integer (square feet)
- **propertyDetails.bedrooms**: Integer
- **propertyDetails.bathrooms**: Float (e.g., 1.5 for 1.5 bathrooms)
- **location.coordinates.lat/lng**: Float (e.g., 43.6532, -79.3832)

### Arrays
- **features**: Array of strings from predefined features list
- **amenities**: Array of strings from predefined amenities list
- **pricing.utilitiesIncluded**: Array of strings from utilities list
- **images**: Array of valid URL strings

### Strings
- **contactInfo.email**: Valid email format
- **images**: Valid URL format
- **virtualTour**: Valid URL format

## Example Documents

### Complete Apartment Listing
```javascript
{
  id: "rent_001",

  // Basic Information
  title: "Modern 2BR Apartment in Downtown Toronto",
  description: "Beautiful modern apartment with stunning city views. Recently renovated with high-end finishes. Perfect for professionals or small families. Close to TTC, shopping, and restaurants.",
  type: "apartment",
  category: "long-term",

  // Location
  location: {
    address: "123 King Street West",
    city: "Toronto",
    province: "Ontario",
    postalCode: "M5H 1A1",
    coordinates: {
      lat: 43.6426,
      lng: -79.3871
    }
  },

  // Property Details
  propertyDetails: {
    bedrooms: 2,
    bathrooms: 2,
    area: 900,
    furnished: "semi-furnished",
    parking: "underground-garage",
    petPolicy: "small-pets-only",
    smokingPolicy: "no-smoking"
  },

  // Pricing
  pricing: {
    rent: 2800.00,
    currency: "CAD",
    deposit: 2800.00,
    utilitiesIncluded: ["heat", "water"],
    additionalFees: [
      {
        name: "Parking",
        amount: 150.00,
        frequency: "monthly"
      }
    ]
  },

  // Contact
  contactInfo: {
    phone: "+1-416-555-0123",
    email: "landlord@example.com",
    preferredContact: "email"
  },

  // Features
  features: [
    "hardwood-floors",
    "granite-counters",
    "stainless-appliances",
    "dishwasher",
    "washer-dryer-included",
    "air-conditioning",
    "balcony"
  ],

  amenities: [
    "gym",
    "pool",
    "rooftop-terrace",
    "24-hour-security",
    "underground-parking",
    "bike-storage"
  ],

  // Availability
  availability: {
    availableFrom: new Date("2024-02-01"),
    leaseTerm: "1-year",
    viewingSchedule: "Weekends 10am-4pm, weekdays by appointment"
  },

  // Media
  images: [
    "https://example.com/image1.jpg",
    "https://example.com/image2.jpg",
    "https://example.com/image3.jpg"
  ],
  virtualTour: "https://example.com/virtual-tour",

  // Status
  status: "approved",
  featured: false,
  verified: true,

  // Analytics
  views: 45,
  inquiries: 8,

  // Metadata
  userId: "user_123",
  createdAt: new Date("2024-01-15T10:30:00Z"),
  updatedAt: new Date("2024-01-15T10:30:00Z")
}
```

### Simple Room Rental
```javascript
{
  id: "rent_002",

  // Basic Information
  title: "Furnished Room in Shared House - Students Welcome",
  description: "Clean, furnished room in a friendly shared house. Perfect for students or young professionals. Shared kitchen and living areas. All utilities included.",
  type: "room",
  category: "student-housing",

  // Location
  location: {
    address: "456 College Street",
    city: "Toronto",
    province: "Ontario"
  },

  // Property Details
  propertyDetails: {
    bedrooms: 1,
    bathrooms: 1, // Shared bathroom
    area: 120,
    furnished: "furnished"
  },

  // Pricing
  pricing: {
    rent: 800.00,
    currency: "CAD",
    deposit: 400.00,
    utilitiesIncluded: ["electricity", "gas", "water", "internet", "heating"]
  },

  // Contact
  contactInfo: {
    phone: "+1-416-555-0456",
    preferredContact: "phone"
  },

  // Features
  features: [
    "internet-included",
    "utilities-included",
    "washer-dryer-included"
  ],

  // Availability
  availability: {
    availableFrom: new Date("2024-01-01"),
    leaseTerm: "month-to-month"
  },

  // Status
  status: "approved",
  featured: false,
  verified: false,

  // Analytics
  views: 23,
  inquiries: 5,

  // Metadata
  userId: "user_456",
  createdAt: new Date("2024-01-10T14:20:00Z"),
  updatedAt: new Date("2024-01-10T14:20:00Z")
}
```

## Validation Rules Summary

1. **Title**: Required, minimum 3 characters
2. **Description**: Required, minimum 10 characters
3. **Type**: Required, must be from predefined list
4. **Category**: Required, must be from predefined list
5. **Location**: Address, city, and province required from predefined lists
6. **Property Details**: Bedrooms, bathrooms, area, and furnished status required
7. **Pricing**: Rent amount required, must be > 0
8. **Availability**: Available from date required, cannot be more than 1 year in past
9. **Contact Info**: All fields optional, but email must be valid format if provided
10. **Status**: Must be from predefined list

## Indexes Recommended

For optimal query performance, create these Firestore indexes:

```javascript
// Composite indexes
rent: [
  ["status", "createdAt"],
  ["type", "status", "createdAt"],
  ["category", "status", "createdAt"],
  ["location.city", "status", "createdAt"],
  ["location.province", "status", "createdAt"],
  ["propertyDetails.bedrooms", "status", "createdAt"],
  ["pricing.rent", "status", "createdAt"],
  ["featured", "status", "createdAt"],
  ["availability.availableFrom", "status", "createdAt"],
  ["userId", "createdAt"]
]

// Single field indexes (auto-created)
- status
- type
- category
- location.city
- location.province
- propertyDetails.bedrooms
- propertyDetails.bathrooms
- pricing.rent
- featured
- verified
- userId
- createdAt
- availability.availableFrom
```

## Security Rules (Firestore)

```javascript
// Allow read access to approved listings
match /rent/{rentId} {
  allow read: if resource.data.status in ['approved', 'active'];
  allow create: if request.auth != null &&
                   request.auth.uid == resource.data.userId;
  allow update: if request.auth != null &&
                   request.auth.uid == resource.data.userId;
  allow delete: if request.auth != null &&
                   request.auth.uid == resource.data.userId;
}

// Admin access (separate admin collection for permissions)
match /rent/{rentId} {
  allow read, write: if request.auth != null &&
                        exists(/databases/$(database)/documents/admins/$(request.auth.uid));
}
```

## Search and Filter Capabilities

The structure supports searching and filtering by:
- **Text Search**: title, description
- **Location**: city, province, address
- **Property Type**: apartment, house, condo, etc.
- **Category**: long-term, short-term, student-housing, etc.
- **Price Range**: minimum and maximum rent
- **Bedrooms/Bathrooms**: exact count or range
- **Area**: minimum square footage
- **Furnished Status**: furnished, semi-furnished, unfurnished
- **Features**: specific amenities and features
- **Availability**: available from date
- **Status**: for admin panel filtering

## Migration Notes

When migrating from the existing `houses` collection:
1. Map existing fields to new structure
2. Set default values for new required fields
3. Convert simple location strings to structured location objects
4. Add status field (default to "approved" for existing listings)
5. Add new required fields with sensible defaults
6. Preserve existing user associations and timestamps
